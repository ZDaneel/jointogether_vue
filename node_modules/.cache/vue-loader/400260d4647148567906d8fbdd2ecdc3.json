{"remainingRequest":"/Users/zdaneel/Desktop/短学期/project/myproj/vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zdaneel/Desktop/短学期/project/myproj/vue/src/views/RetrievePassword.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zdaneel/Desktop/短学期/project/myproj/vue/src/views/RetrievePassword.vue","mtime":1654619705667},{"path":"/Users/zdaneel/Desktop/短学期/project/myproj/vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zdaneel/Desktop/短学期/project/myproj/vue/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/zdaneel/Desktop/短学期/project/myproj/vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zdaneel/Desktop/短学期/project/myproj/vue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICAvLzE5MjAwMTMwMjI0QHBvc3QudXN0cy5lZHUuY24KICBuYW1lOiAiUmV0cmlldmVQYXNzd29yZCIsCiAgZGF0YSgpIHsKICAgIGxldCBjaGVja0VtYWlsID0gKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4gewogICAgICBjb25zdCBtYWlsUmVnID0gL14oW2EtekEtWjAtOV8tXSkrQChbYS16QS1aMC05Xy1dKSsoLlthLXpBLVowLTlfLV0pKy8KICAgICAgaWYgKCF2YWx1ZSkgewogICAgICAgIHJldHVybiBjYWxsYmFjayhuZXcgRXJyb3IoJ+mCrueuseS4jeiDveS4uuepuicpKQogICAgICB9CiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIGlmIChtYWlsUmVnLnRlc3QodmFsdWUpKSB7CiAgICAgICAgICBjYWxsYmFjaygpCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcign6K+36L6T5YWl5q2j56Gu55qE6YKu566x5qC85byPJykpCiAgICAgICAgfQogICAgICB9LCAxMDApCiAgICB9CiAgICByZXR1cm4gewogICAgICBlMTogMSwKICAgICAgdXNlcjoge30sCiAgICAgIHB3ZEZyb206IHt9LAogICAgICBtc2c6ICLngrnlh7vojrflj5bpqozor4HnoIEiLAogICAgICBmbGFnOiBmYWxzZSwKICAgICAgRW1haWw6ICIiLAogICAgICBydWxlczogewogICAgICAgIGVtYWlsOiBbCiAgICAgICAgICB7dmFsaWRhdG9yOiBjaGVja0VtYWlsLCB0cmlnZ2VyOiAnYmx1cid9CiAgICAgICAgXSwKICAgICAgfSwKICAgICAgcnVsZXMyOiB7CiAgICAgICAgcGFzc3dvcmQ6IFsKICAgICAgICAgIHtyZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+i+k+WFpeWvhueggScsIHRyaWdnZXI6ICdibHVyJ30sCiAgICAgICAgICB7bWluOiAxLCBtYXg6IDIwLCBtZXNzYWdlOiAn6ZW/5bqm5ZyoIDEg5YiwIDIwIOS4quWtl+espicsIHRyaWdnZXI6ICdibHVyJ30KICAgICAgICBdLAogICAgICAgIGNvbmZpcm1QYXNzd29yZDogWwogICAgICAgICAge3JlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36L6T5YWl5a+G56CBJywgdHJpZ2dlcjogJ2JsdXInfSwKICAgICAgICAgIHttaW46IDEsIG1heDogMjAsIG1lc3NhZ2U6ICfplb/luqblnKggMSDliLAgMjAg5Liq5a2X56ymJywgdHJpZ2dlcjogJ2JsdXInfQogICAgICAgIF0sCiAgICAgIH0KICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGdldEF1dGhDb2RlKCkgewogICAgICB0aGlzLiRyZWZzWydmb3JtJ10udmFsaWRhdGUoKHZhbGlkKSA9PiB7CiAgICAgICAgaWYgKHZhbGlkKSB7ICAvLyDooajljZXmoKHpqozlkIjms5UKICAgICAgICAgIHRoaXMucmVxdWVzdC5wb3N0KCIvdXNlci9jaGVja0VtYWlsIiwgdGhpcy51c2VyKS50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgIGlmIChyZXMuY29kZSA9PT0gJzIwMCcpIHsKICAgICAgICAgICAgICAvL3RoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygi6YKu566x5a2Y5ZyoIikKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpCiAgICAgICAgICAgICAgdGhpcy5FbWFpbCA9IHJlcy5kYXRhLmVtYWlsCiAgICAgICAgICAgICAgY29uc3QgX3RoaXMgPSB0aGlzOy8v77yB77yB5Z2R77yBc2V0SW50ZXJ2YWzkuK3nmoR0aGlz5oyH5ZCR6Zeu6aKYCiAgICAgICAgICAgICAgdGhpcy5mbGFnID0gdHJ1ZTsgLy/vvIHmjInpkq7kuI3lj6/ph43lpI3ngrnlh7sKICAgICAgICAgICAgICBsZXQgdGltZSA9IDkwOy8v5a6a5LmJ5pe26Ze05Y+Y6YePIDE1MHMKICAgICAgICAgICAgICBsZXQgdGltZXIgPSBudWxsOy8v5a6a5LmJ5a6a5pe25ZmoCiAgICAgICAgICAgICAgdGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBpZiAodGltZSA9PT0gMCkgewogICAgICAgICAgICAgICAgICBfdGhpcy5tc2cgPSAi6YeN5paw6I635Y+W6aqM6K+B56CBIjsKICAgICAgICAgICAgICAgICAgX3RoaXMuZmxhZyA9IGZhbHNlOwogICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKHRpbWVyKTsvL+a4hemZpOWumuaXtuWZqAogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgX3RoaXMubXNnID0gdGltZSArICLnp5LlkI7ph43mlrDojrflj5YiOwogICAgICAgICAgICAgICAgICB0aW1lLS07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSwgMTAwMCkKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5tc2cpCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pCiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBjaGVja0NvZGUoKSB7CiAgICAgIGlmICh0aGlzLnVzZXIuZW1haWwgPT0gbnVsbCkgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIumCrueuseS4jeiDveS4uuepuiIpCiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgIH0KICAgICAgZWxzZSBpZiAodGhpcy51c2VyLnZlckNvZGUgPT0gbnVsbCkgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIumqjOivgeeggeS4jeiDveS4uuepuiIpCiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgIH0KICAgICAgZWxzZSB7CiAgICAgICAgdGhpcy5yZXF1ZXN0LnBvc3QoIi91c2VyL2NoZWNrQ29kZSIsIHRoaXMudXNlcikudGhlbihyZXMgPT4gewogICAgICAgICAgY29uc29sZS5sb2cocmVzKQogICAgICAgICAgaWYgKHJlcy5jb2RlID09PSAnMjAwJykgewogICAgICAgICAgICAvL3RoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygi6YeN572u5oiQ5YqfIikKICAgICAgICAgICAgY29uc29sZS5sb2cocmVzLmRhdGEpCiAgICAgICAgICAgIGlmIChyZXMuZGF0YSA9PT0gJ3RydWUnKSB7CiAgICAgICAgICAgICAgdGhpcy5lMSA9IDIKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLpqozor4HnoIHplJnor6/vvIEiKQogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5tc2cpCiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgfQogICAgfSwKICAgIGNoYW5nZVBXRCgpIHsKICAgICAgdGhpcy4kcmVmc1snZm9ybTInXS52YWxpZGF0ZSgodmFsaWQpID0+IHsKICAgICAgICBpZiAodmFsaWQpIHsgIC8vIOihqOWNleagoemqjOWQiOazlQogICAgICAgICAgaWYgKHRoaXMucHdkRnJvbS5wYXNzd29yZCAhPT0gdGhpcy5wd2RGcm9tLmNvbmZpcm1QYXNzd29yZCkgewogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLkuKTmrKHovpPlhaXnmoTlr4bnoIHkuI3kuIDoh7QiKQogICAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMucHdkRnJvbS5lbWFpbCA9IHRoaXMuRW1haWwKICAgICAgICAgIC8vY29uc29sZS5sb2codGhpcy5wd2RGcm9tKQogICAgICAgICAgdGhpcy5yZXF1ZXN0LnBvc3QoIi91c2VyL3Jlc2V0UGFzc3dvcmQiLCB0aGlzLnB3ZEZyb20pLnRoZW4ocmVzID0+IHsKICAgICAgICAgICAgaWYgKHJlcy5jb2RlID09PSAnMjAwJykgewogICAgICAgICAgICAgIC8vdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCLph43nva7miJDlip8iKQogICAgICAgICAgICAgIHRoaXMuZTEgPSAzCiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXMubXNnKQogICAgICAgICAgICB9CiAgICAgICAgICB9KQogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSwKfQo="},{"version":3,"sources":["RetrievePassword.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"RetrievePassword.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"wrapper\">\n    <div\n        style=\"margin: 200px auto; background-color: #fff; width: 550px; height: 400px; padding: 20px; border-radius: 10px\">\n      <div style=\"margin: 20px 0; text-align: center; font-size: 24px\"><b>找 回 密 码</b></div>\n      <v-stepper v-model=\"e1\">\n        <v-stepper-header>\n          <v-stepper-step :complete=\"e1 > 1\" step=\"1\">身份验证</v-stepper-step>\n          <v-divider></v-divider>\n          <v-stepper-step :complete=\"e1 > 2\" step=\"2\">密码重置</v-stepper-step>\n          <v-divider></v-divider>\n          <v-stepper-step step=\"3\">重置完成</v-stepper-step>\n        </v-stepper-header>\n\n        <v-stepper-items>\n          <v-stepper-content step=\"1\">\n            <!-- 步骤一的内容-->\n            <el-form ref=\"form\" :rules=\"rules\" :model=\"user\">\n              <el-form-item prop=\"email\">\n                <el-input placeholder=\"请输入邮箱\" size=\"medium\" style=\"margin: 5px 0; width: 70%\"\n                          prefix-icon=\"el-icon-message\" v-model=\"user.email\"></el-input>\n                <el-button type=\"primary\" size=\"small\" :disabled=\"flag\" @click=\"getAuthCode\">{{ msg }}</el-button>\n              </el-form-item>\n              <el-form-item prop=\"verCode\">\n                <el-input placeholder=\"请输入验证码\" size=\"medium\" style=\"margin: 5px 0\" v-model=\"user.verCode\"></el-input>\n              </el-form-item>\n              <el-form-item style=\"margin: 5px 0; text-align: center\">\n                <el-button type=\"primary\" size=\"small\" autocomplete=\"off\" @click=\"checkCode\">下一步</el-button>\n                <el-button size=\"small\" autocomplete=\"off\" @click=\"$router.push('/login')\">返回登录</el-button>\n              </el-form-item>\n            </el-form>\n          </v-stepper-content>\n\n          <v-stepper-content step=\"2\">\n            <!-- 步骤二的内容-->\n            <el-form ref=\"form2\" :rules=\"rules2\" :model=\"pwdFrom\">\n              <el-form-item prop=\"password\">\n                <el-input placeholder=\"请输入密码\" size=\"medium\" style=\"margin: 5px 0\" prefix-icon=\"el-icon-lock\"\n                          show-password v-model=\"pwdFrom.password\"></el-input>\n              </el-form-item>\n              <el-form-item prop=\"confirmPassword\">\n                <el-input placeholder=\"请确认密码\" size=\"medium\" style=\"margin: 5px 0\" prefix-icon=\"el-icon-lock\"\n                          show-password v-model=\"pwdFrom.confirmPassword\"></el-input>\n              </el-form-item>\n              <el-form-item style=\"margin: 5px 0; text-align: center\">\n                <el-button type=\"primary\" size=\"small\" autocomplete=\"off\" @click=\"changePWD\">下一步</el-button>\n                <el-button size=\"small\" autocomplete=\"off\" @click=\"$router.push('/login')\">返回登录</el-button>\n              </el-form-item>\n            </el-form>\n          </v-stepper-content>\n\n          <v-stepper-content step=\"3\">\n            <!-- 步骤三的内容-->\n            <div style=\"text-align: center\">\n              <div>\n                <br><br>密码重置完成，请重新登录!<br><br><br><br>\n              </div>\n              <el-button type=\"primary\" size=\"middle\" @click=\"$router.push('/login')\">重新登录</el-button>\n            </div>\n          </v-stepper-content>\n\n        </v-stepper-items>\n      </v-stepper>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  //19200130224@post.usts.edu.cn\n  name: \"RetrievePassword\",\n  data() {\n    let checkEmail = (rule, value, callback) => {\n      const mailReg = /^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/\n      if (!value) {\n        return callback(new Error('邮箱不能为空'))\n      }\n      setTimeout(() => {\n        if (mailReg.test(value)) {\n          callback()\n        } else {\n          callback(new Error('请输入正确的邮箱格式'))\n        }\n      }, 100)\n    }\n    return {\n      e1: 1,\n      user: {},\n      pwdFrom: {},\n      msg: \"点击获取验证码\",\n      flag: false,\n      Email: \"\",\n      rules: {\n        email: [\n          {validator: checkEmail, trigger: 'blur'}\n        ],\n      },\n      rules2: {\n        password: [\n          {required: true, message: '请输入密码', trigger: 'blur'},\n          {min: 1, max: 20, message: '长度在 1 到 20 个字符', trigger: 'blur'}\n        ],\n        confirmPassword: [\n          {required: true, message: '请输入密码', trigger: 'blur'},\n          {min: 1, max: 20, message: '长度在 1 到 20 个字符', trigger: 'blur'}\n        ],\n      }\n    }\n  },\n  methods: {\n    getAuthCode() {\n      this.$refs['form'].validate((valid) => {\n        if (valid) {  // 表单校验合法\n          this.request.post(\"/user/checkEmail\", this.user).then(res => {\n            if (res.code === '200') {\n              //this.$message.success(\"邮箱存在\")\n              console.log(res)\n              this.Email = res.data.email\n              const _this = this;//！！坑！setInterval中的this指向问题\n              this.flag = true; //！按钮不可重复点击\n              let time = 90;//定义时间变量 150s\n              let timer = null;//定义定时器\n              timer = setInterval(function () {\n                if (time === 0) {\n                  _this.msg = \"重新获取验证码\";\n                  _this.flag = false;\n                  clearInterval(timer);//清除定时器\n                } else {\n                  _this.msg = time + \"秒后重新获取\";\n                  time--;\n                }\n              }, 1000)\n            } else {\n              this.$message.error(res.msg)\n            }\n          })\n        }\n      });\n    },\n    checkCode() {\n      if (this.user.email == null) {\n        this.$message.error(\"邮箱不能为空\")\n        return false\n      }\n      else if (this.user.verCode == null) {\n        this.$message.error(\"验证码不能为空\")\n        return false\n      }\n      else {\n        this.request.post(\"/user/checkCode\", this.user).then(res => {\n          console.log(res)\n          if (res.code === '200') {\n            //this.$message.success(\"重置成功\")\n            console.log(res.data)\n            if (res.data === 'true') {\n              this.e1 = 2\n            } else {\n              this.$message.error(\"验证码错误！\")\n            }\n          } else {\n            this.$message.error(res.msg)\n          }\n        })\n      }\n    },\n    changePWD() {\n      this.$refs['form2'].validate((valid) => {\n        if (valid) {  // 表单校验合法\n          if (this.pwdFrom.password !== this.pwdFrom.confirmPassword) {\n            this.$message.error(\"两次输入的密码不一致\")\n            return false\n          }\n          this.pwdFrom.email = this.Email\n          //console.log(this.pwdFrom)\n          this.request.post(\"/user/resetPassword\", this.pwdFrom).then(res => {\n            if (res.code === '200') {\n              //this.$message.success(\"重置成功\")\n              this.e1 = 3\n            } else {\n              this.$message.error(res.msg)\n            }\n          })\n        }\n      });\n    }\n  },\n}\n</script>\n\n<style>\n.wrapper {\n  height: 100vh;\n  background: linear-gradient(red, transparent),\n  linear-gradient(to top left, lime, transparent),\n  linear-gradient(to top right, blue, transparent);\n  background-blend-mode: screen;\n  overflow: hidden;\n}\n</style>"]}]}