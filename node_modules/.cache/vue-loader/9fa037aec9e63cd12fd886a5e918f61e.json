{"remainingRequest":"/Users/zdaneel/Downloads/Java/JavaEE/demo/vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zdaneel/Downloads/Java/JavaEE/demo/vue/src/views/RetrievePassword.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"/Users/zdaneel/Downloads/Java/JavaEE/demo/vue/src/views/RetrievePassword.vue","mtime":1654619705667},{"path":"/Users/zdaneel/Downloads/Java/JavaEE/demo/vue/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zdaneel/Downloads/Java/JavaEE/demo/vue/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/zdaneel/Downloads/Java/JavaEE/demo/vue/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/zdaneel/Downloads/Java/JavaEE/demo/vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zdaneel/Downloads/Java/JavaEE/demo/vue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi53cmFwcGVyIHsKICBoZWlnaHQ6IDEwMHZoOwogIGJhY2tncm91bmQ6IGxpbmVhci1ncmFkaWVudChyZWQsIHRyYW5zcGFyZW50KSwKICBsaW5lYXItZ3JhZGllbnQodG8gdG9wIGxlZnQsIGxpbWUsIHRyYW5zcGFyZW50KSwKICBsaW5lYXItZ3JhZGllbnQodG8gdG9wIHJpZ2h0LCBibHVlLCB0cmFuc3BhcmVudCk7CiAgYmFja2dyb3VuZC1ibGVuZC1tb2RlOiBzY3JlZW47CiAgb3ZlcmZsb3c6IGhpZGRlbjsKfQo="},{"version":3,"sources":["RetrievePassword.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"RetrievePassword.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"wrapper\">\n    <div\n        style=\"margin: 200px auto; background-color: #fff; width: 550px; height: 400px; padding: 20px; border-radius: 10px\">\n      <div style=\"margin: 20px 0; text-align: center; font-size: 24px\"><b>找 回 密 码</b></div>\n      <v-stepper v-model=\"e1\">\n        <v-stepper-header>\n          <v-stepper-step :complete=\"e1 > 1\" step=\"1\">身份验证</v-stepper-step>\n          <v-divider></v-divider>\n          <v-stepper-step :complete=\"e1 > 2\" step=\"2\">密码重置</v-stepper-step>\n          <v-divider></v-divider>\n          <v-stepper-step step=\"3\">重置完成</v-stepper-step>\n        </v-stepper-header>\n\n        <v-stepper-items>\n          <v-stepper-content step=\"1\">\n            <!-- 步骤一的内容-->\n            <el-form ref=\"form\" :rules=\"rules\" :model=\"user\">\n              <el-form-item prop=\"email\">\n                <el-input placeholder=\"请输入邮箱\" size=\"medium\" style=\"margin: 5px 0; width: 70%\"\n                          prefix-icon=\"el-icon-message\" v-model=\"user.email\"></el-input>\n                <el-button type=\"primary\" size=\"small\" :disabled=\"flag\" @click=\"getAuthCode\">{{ msg }}</el-button>\n              </el-form-item>\n              <el-form-item prop=\"verCode\">\n                <el-input placeholder=\"请输入验证码\" size=\"medium\" style=\"margin: 5px 0\" v-model=\"user.verCode\"></el-input>\n              </el-form-item>\n              <el-form-item style=\"margin: 5px 0; text-align: center\">\n                <el-button type=\"primary\" size=\"small\" autocomplete=\"off\" @click=\"checkCode\">下一步</el-button>\n                <el-button size=\"small\" autocomplete=\"off\" @click=\"$router.push('/login')\">返回登录</el-button>\n              </el-form-item>\n            </el-form>\n          </v-stepper-content>\n\n          <v-stepper-content step=\"2\">\n            <!-- 步骤二的内容-->\n            <el-form ref=\"form2\" :rules=\"rules2\" :model=\"pwdFrom\">\n              <el-form-item prop=\"password\">\n                <el-input placeholder=\"请输入密码\" size=\"medium\" style=\"margin: 5px 0\" prefix-icon=\"el-icon-lock\"\n                          show-password v-model=\"pwdFrom.password\"></el-input>\n              </el-form-item>\n              <el-form-item prop=\"confirmPassword\">\n                <el-input placeholder=\"请确认密码\" size=\"medium\" style=\"margin: 5px 0\" prefix-icon=\"el-icon-lock\"\n                          show-password v-model=\"pwdFrom.confirmPassword\"></el-input>\n              </el-form-item>\n              <el-form-item style=\"margin: 5px 0; text-align: center\">\n                <el-button type=\"primary\" size=\"small\" autocomplete=\"off\" @click=\"changePWD\">下一步</el-button>\n                <el-button size=\"small\" autocomplete=\"off\" @click=\"$router.push('/login')\">返回登录</el-button>\n              </el-form-item>\n            </el-form>\n          </v-stepper-content>\n\n          <v-stepper-content step=\"3\">\n            <!-- 步骤三的内容-->\n            <div style=\"text-align: center\">\n              <div>\n                <br><br>密码重置完成，请重新登录!<br><br><br><br>\n              </div>\n              <el-button type=\"primary\" size=\"middle\" @click=\"$router.push('/login')\">重新登录</el-button>\n            </div>\n          </v-stepper-content>\n\n        </v-stepper-items>\n      </v-stepper>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  //19200130224@post.usts.edu.cn\n  name: \"RetrievePassword\",\n  data() {\n    let checkEmail = (rule, value, callback) => {\n      const mailReg = /^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/\n      if (!value) {\n        return callback(new Error('邮箱不能为空'))\n      }\n      setTimeout(() => {\n        if (mailReg.test(value)) {\n          callback()\n        } else {\n          callback(new Error('请输入正确的邮箱格式'))\n        }\n      }, 100)\n    }\n    return {\n      e1: 1,\n      user: {},\n      pwdFrom: {},\n      msg: \"点击获取验证码\",\n      flag: false,\n      Email: \"\",\n      rules: {\n        email: [\n          {validator: checkEmail, trigger: 'blur'}\n        ],\n      },\n      rules2: {\n        password: [\n          {required: true, message: '请输入密码', trigger: 'blur'},\n          {min: 1, max: 20, message: '长度在 1 到 20 个字符', trigger: 'blur'}\n        ],\n        confirmPassword: [\n          {required: true, message: '请输入密码', trigger: 'blur'},\n          {min: 1, max: 20, message: '长度在 1 到 20 个字符', trigger: 'blur'}\n        ],\n      }\n    }\n  },\n  methods: {\n    getAuthCode() {\n      this.$refs['form'].validate((valid) => {\n        if (valid) {  // 表单校验合法\n          this.request.post(\"/user/checkEmail\", this.user).then(res => {\n            if (res.code === '200') {\n              //this.$message.success(\"邮箱存在\")\n              console.log(res)\n              this.Email = res.data.email\n              const _this = this;//！！坑！setInterval中的this指向问题\n              this.flag = true; //！按钮不可重复点击\n              let time = 90;//定义时间变量 150s\n              let timer = null;//定义定时器\n              timer = setInterval(function () {\n                if (time === 0) {\n                  _this.msg = \"重新获取验证码\";\n                  _this.flag = false;\n                  clearInterval(timer);//清除定时器\n                } else {\n                  _this.msg = time + \"秒后重新获取\";\n                  time--;\n                }\n              }, 1000)\n            } else {\n              this.$message.error(res.msg)\n            }\n          })\n        }\n      });\n    },\n    checkCode() {\n      if (this.user.email == null) {\n        this.$message.error(\"邮箱不能为空\")\n        return false\n      }\n      else if (this.user.verCode == null) {\n        this.$message.error(\"验证码不能为空\")\n        return false\n      }\n      else {\n        this.request.post(\"/user/checkCode\", this.user).then(res => {\n          console.log(res)\n          if (res.code === '200') {\n            //this.$message.success(\"重置成功\")\n            console.log(res.data)\n            if (res.data === 'true') {\n              this.e1 = 2\n            } else {\n              this.$message.error(\"验证码错误！\")\n            }\n          } else {\n            this.$message.error(res.msg)\n          }\n        })\n      }\n    },\n    changePWD() {\n      this.$refs['form2'].validate((valid) => {\n        if (valid) {  // 表单校验合法\n          if (this.pwdFrom.password !== this.pwdFrom.confirmPassword) {\n            this.$message.error(\"两次输入的密码不一致\")\n            return false\n          }\n          this.pwdFrom.email = this.Email\n          //console.log(this.pwdFrom)\n          this.request.post(\"/user/resetPassword\", this.pwdFrom).then(res => {\n            if (res.code === '200') {\n              //this.$message.success(\"重置成功\")\n              this.e1 = 3\n            } else {\n              this.$message.error(res.msg)\n            }\n          })\n        }\n      });\n    }\n  },\n}\n</script>\n\n<style>\n.wrapper {\n  height: 100vh;\n  background: linear-gradient(red, transparent),\n  linear-gradient(to top left, lime, transparent),\n  linear-gradient(to top right, blue, transparent);\n  background-blend-mode: screen;\n  overflow: hidden;\n}\n</style>"]}]}